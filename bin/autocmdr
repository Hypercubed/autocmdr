#!/usr/bin/env node

// node
var path			= require('path');

// autocmdr
var program  = require('../');

// Plugins
require('../lib/logger.js')(program);
require('../lib/package.js')(program);
require('../lib/config.js')(program);
require('../lib/eco.js')(program);

program
	.option('-g, --global', "use global autocmdr tasks")
	.once('global', function() {
		var dirpath = path.join(__dirname,'../cmds/');
		require('../lib/loader.js')(program, { cmdspath: dirpath });
	});

program
	.on('*', function(name) { 
		program.logger.log('warn', '\''+name+'\' is not a known command. See \''+program._name+' --help\'.');
	});

var argv = program.normalize(process.argv);

if (argv.indexOf('-g') < 0) {
	var dirpath = path.join(process.cwd(), 'cmds/');
	require('../lib/loader.js')(program, { cmdspath: dirpath });
}

program.parse(argv);

if (program.args.length < 1 )
	program.outputHelp();